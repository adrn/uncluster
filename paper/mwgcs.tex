% General notes:
% - Should cite: https://ui.adsabs.harvard.edu/#abs/2014ApJ...784...95M/abstract

\documentclass[manuscript, letterpaper]{aastex6}

\include{gitstuff}
\include{aastexmods}
\include{preamble}

\begin{document}

\title{Globular cluster destruction in the Milky Way halo I: ??}
\author{Adrian~M.~Price-Whelan\altaffilmark{\pu,\adrn} +++
%        Oleg Gnedin\altaffilmark{\umich}
%        Kathryn V. Johnston\altaffilmark{\colum}
%        David N. Spergel\altaffilmark{\cca,\pu}
%       Hans-Walter~Rix\altaffilmark{\mpia}
}

% Affiliations
\newcommand{\pu}{1}
\newcommand{\adrn}{2}
% \newcommand{\umich}{3}
% \newcommand{\colum}{4}
% \newcommand{\cca}{5}
%\newcommand{\mpia}{6}

\altaffiltext{\pu}{Department of Astrophysical Sciences,
                   Princeton University, Princeton, NJ 08544, USA}
\altaffiltext{\adrn}{To whom correspondence should be addressed:
                     \texttt{adrn@princeton.edu}}

% TODO: michigan
% \altaffiltext{\umich}{Department of Astronomy ??,
%                       University of Michigan,
%                       USA}
% \altaffiltext{\colum}{Department of Astronomy,
%                       Columbia University,
%                       550 W 120th St.,
%                       New York, NY 10027, USA}
% TODO: Simons
% \altaffiltext{\cca}{Simons Center for Computational Astrophysics,
%                       New York, NY XXX, USA}
%\altaffiltext{\mpia}{Max-Planck-Institut f\"ur Astronomie,
%                    K\"onigstuhl 17, D-69117 Heidelberg, Germany}

\begin{abstract}
% Context
Milky Way halo globular clusters probably accreted -- opportunity to study accretion history, blah blah.


Recent work studying the detailed chemical abundances of Milky Way halo stars
and the kinematic evolution of globular clusters suggest that (1) a significant
fraction of the stellar halo around the Milky Way could be composed of disrupted
globular clusters, and, consequently, that (2) the present globular cluster
population may be a small fraction ($<$5\%) of the initial population.
These suggestions make strong predictions about the structure---in kinematics
and chemistry---of halo stars that depend strongly on the origins of the initial
globular cluster system.
% Aims
Here we generate a set of mock stellar halos formed from disrupted globular
clusters with a range of formation scenarios that all broadly reproduce the
present-day spatial distribution and mass function of the remnant cluster
population.
We use these halos to predict the kinematic clustering of halo stars and the
expected number of thin stellar streams around the Milky Way for each of the
explored scenarios.
% Methods
We consider two main classes of initial conditions: (1) all accreted, in which
all globular clusters were deposited early on through mergers with other
galaxies, and (2) all formed in situ, in which all globular clusters formed
early on in the Galaxy.
For each, we consider cluster orbits drawn from isotropic, radially-anisotropic,
and tangentially-anisotropic distribution functions.
% Results
We find that the end-of-Gaia kinematic measurements for XX stars within XX kpc
of the Sun will distinguish the scenarios considered in this work.
We also predict that within XX kpc of the Galactic center, there are XX thin,
recently fully-disrupted globular-cluster streams.
Of these, XX have high enough surface brightness to have already been detected,
in agreement with the number of thin streams discovered thus far.

\end{abstract}

\keywords{
  Galaxy: halo
  ---
  globular clusters: general
  ---
  stars: kinematics and dynamics
  ---
  Galaxy: structure
  ---
  Galaxy: kinematics and dynamics
}

\section{Introduction}\label{sec:introduction}

\todo{Write the introduction!}

Comment on: surface brightness fluctuations at z=2, assuming 10000 GCs

Bimodal GC population of MW - population formed in MW vs. accreted?

Ignore MW / metal rich pop because likely formed in close proximity to the disk

\section{Methods}\label{sec:methods}

The Milky Way hosts at least $\approx$160 globular clusters (GCs) between
Galactocentric radii $1 \lesssim r \lesssim 125~\kpc$ with a total bound mass
$M_{{\rm tot},z=0} \approx 4.5 \times 10^7~\msun$.
The mass distribution and spherically-averaged number density of all known GCs
is shown in \figname~\ref{fig:mw-gc-pop}.
It is expected that the initial population of GCs around the Milky Way was much
more numerous but that some number of GCs have been destroyed by a combination
of the tidal field of the Galaxy and internal relaxation processes (see, e.g.,
\citealt{Gnedin:1997}).
The number of initial clusters and total stellar mass from this disrupted
population will depend strongly on the assembly history and evolution of the
globular cluster system.
Here, our goal is to broadly reproduce the properties of the present-day GC
population with different models for the initial GC population, varying the
dynamical origin of the clusters.
As shown in subsequent sections, different models for the initial population of
GCs lead to vastly different predictions for the amount of mass contributed to
the stellar halo by disrupted GCs, the amount of kinematic substructure in the
halo, and the number of thin stellar streams observable today.

\begin{figure*}[h]
\begin{center}
\includegraphics[width=\textwidth]{figures/mass-gcdensity.pdf}
\end{center}
\caption{%
\todo{caption}
\label{fig:mw-gc-pop}}
\end{figure*}

We consider two qualitatively different sets of scenarios:
\begin{enumerate}
  \item The globular cluster system is in place (whether accreted or formed
    early on) around the Milky Way at redshift $z=3$ and evolves to present day.
    % with orbits drawn from a spherical, isotropic distribution function (\df)
  \item The globular clusters are deposited into the Milky Way from
    cosmologically-accreted, tidally-disrupted satellite galaxies.
    % with orbits drawn from subhalo orbits in a cosmological simulation.
\end{enumerate}
Within each of these broad scenarios, we vary the details as described in
\sectionname~\ref{sec:TODO}.
For each sub-scenario, we require that the number of surviving clusters is
between 150--200 (\todo{arbitrary numbers!}) and that their mass distribution is
qualitatively similar to that of the observed GCs around the Milky Way.
In the subsections that follow we describe the methods we use to simulate the
different scenarios.

\todo{What cosmology do we use?}

% For scenario 3, we use orbits of subhalos drawn from the Aquarius simulations
% (\citealt{aquarius}) and set the number of GCs in each satellite using a $M_{\rm
% halo}$-$M_{\rm GC}$ scaling relation (\citealt{Harris:2015}). \todo{What?}
% With orbital initial conditions for the GCs (from the three scenarios above), a
% mass model for the Milky Way, and an initial mass function for the cluster
% masses we can evolve a given GC population forward to present day and compare
% the population of surviving clusters with that observed around the Milky Way.

\subsection{Milky Way mass model} \label{sec:massmodel}

For the gravitational potential of the Milky Way, we use a multi-component
mass-model consisting of a spherical Navarro-Frenk-White (NFW) dark matter halo
(H; \citealt{Navarro:1996}), a Miyamoto-Nagai disk (D; \citealt{Miyamoto:1975}),
and a sum of spherical Hernquist profiles (\citealt{Hernquist:1990}) to model
the mass distribution in the central Galaxy (bulge, B, and nucleus, N).
The gravitational potential expressions for these components are:
\begin{eqnarray}
  \Phi_{\rm H}(r,t) &=& \frac{G \, M_{\rm H}(t)}{r_{\rm H}} \, \frac{\ln{(1+r/r_{\rm H})}}{r/r_{\rm H}}
  \\
  \Phi_{\rm D}(R,z,t) &=& -\frac{G \, M_{\rm D}(t)}
    {\sqrt{R^2 + \left(R_{\rm D}(t) + \sqrt{z^2 + z_{\rm D}^2}\right)^2}}
  \\
  \Phi_{\rm B}(r,t) &=& -\frac{G \, M_{\rm B}(t)}{r + r_{\rm B}(t)}
  \\
  \Phi_{\rm N}(r,t) &=& -\frac{G \, M_{\rm N}(t)}{r + r_{\rm N}(t)} \quad ,
\end{eqnarray}
where $r$ is the spherical radius and $R$ the cylindrical radius and
the time-dependent parameters are noted.
This is a relatively simple model for the Milky Way potential, but we see no
justification for making the halo model more complex given the vast
uncertainties in the shape and profile of the dark matter halo.

At present-day ($z=0$), we set the potential parameters as follows:
We fix the Bulge and Disk parameters following \citealt{Bovy:2015}.
We fit for the halo mass, halo scale radius, nucleus mass, and nucleus scale
radius using standard nonlinear least-squares fitting with a compilation of
Milky Way enclosed-mass measurements (\citealt{Koposov:2010,Deason:2012,
Deason:2012a,Gibbons:2014,Kupper:2015,MORETODO}).
The best-fit or adopted parameter values for the $z=0$ potential are given in
\tblname~\ref{tbl:potential-params}.
In \figname~\ref{fig:mass-profile} we plot the mass enclosed as a function of
radius (thick line) and the enclosed-mass measurements used to fit for the free
potential parameters (points and error bars).

\begin{figure*}[h]
\begin{center}
\includegraphics[width=0.65\textwidth]{figures/mass-profile.pdf}
\end{center}
\caption{%
\todo{caption}
\todo{What's going on at small radii? Bug in Gala?}
\label{fig:mass-profile}}
\end{figure*}

To evaluate the potential at a past time, we fix the form of the potential but
assume that the mass and scale radii of each component evolve.
In detail, we assume that:
the virial mass of the halo decreases approximately exponentially with
increasing redshift and the virial radius is proportional to the cube-root of
the virial mass times the scale factor $a$ (e.g.,
\citealt{Krumholz:2012,Dekel:2006}), the mass of the combined disk, bulge, and
nucleus decreases approximately linearly with lookback time (but in detail
follows the prescription of \citealt{Leitner:2012}) at constant ratios, and the
scale lengths of the disk, bulge, and nucleus decrease in proportion to the
virial radius (e.g., \citealt{Kravtsov:2013}).
We assume that the dark matter scale radius is constant with redshift leading to
halo concentration, $c = R_{\rm vir} / r_{\rm H}$, evolution similar to that
seen in cosmological simulations (e.g., \citealt{Munoz-Cuartas:2011}).
In terms of the virial quantities, the halo scale mass, $M_{\rm H}$, is given by
\begin{eqnarray}
  M_{\rm H}(t) &=& \frac{M_{\rm vir}}{\ln(c+1) - c/(c+1)}
\end{eqnarray}
and only grows by a factor of $\approx$2.75 from $z=3$ to present, while the
virial mass of the halo grows by a factor of $\approx$15 (as is roughly
consistent with, e.g., \citealt{Cuesta:2008,Diemer:2013}), where $c = r_{\rm
vir}(t) / r_{\rm H}$ is the halo concentration.
The present-day virial mass and radius in this model is $M_{\rm vir}(0) \approx
8.4 \times 10^{11}~\msun$ and $r_{\rm vir}(0) \approx 250~\kpc$.

The expressions used to evolve the potential parameters are:
\begin{eqnarray}
  M_{\rm vir}(z) &=& M_{\rm vir}(0) \, e^{-0.9 \, z}
  \\
  r_{\rm vir}(z) &\approx& 309 \, \left(\frac{M_{\rm vir}}{10^{12}~\msun}\right)^{1/3} \,
    \left(\frac{\Delta}{200}\right)^{-1/3} \, \left(\frac{\Omega_m}{0.3}\right)^{-1/3} \, \left(\frac{h}{0.7}\right)^{-2/3} \,
    (1+z)^{-1} \, {\rm kpc}
  \\
  M_{\rm D,B,N}(t) &=& M_{\rm D, B, N}(0) \, f_*(t)
  \\
  R_{\rm D,B,N}(t) &=& R_{\rm D,B,N}(0) \, \frac{r_{\rm vir}(t)}{r_{\rm vir}(0)}
  \quad ,
\end{eqnarray}
where $t=0$, $z=0$ is present day and we evolve the clusters starting at $t_0 =
-11.2 ~{\rm Gyr}$, $z_0 = 2.5$.
The form of $f_*(t)$ and parameters are taken from
\citealt{Leitner:2012} (see Appendix, \eqname~A3 in their work).
\figname~\ref{fig:mass-evolution} shows the evolution of the virial mass, mass
enclosed within the halo scale radius, and virial radius as functions of
redshift.

\begin{floattable}
\begin{deluxetable}{r l}
\tabletypesize{\footnotesize}
\caption{Parameters for the adopted Milky Way gravitational potential model at
present day ($z=0$) \label{tbl:potential-params}}

\tablehead{%
    \colhead{name} & \colhead{value}
}
\startdata
$M_{\rm H}$ & $4.51 \times 10^{11}~\msun$ \\
$r_{\rm H}$ & $13.2~\kpc$ \\
\hline
$M_{\rm D}$ & $6.8 \times 10^{10}~\msun$ \\
$R_{\rm D}$ & $3~\kpc$ \\
$z_{\rm D}$ & $280~\pc$ \\
\hline
$M_{\rm B}$ & $5 \times 10^{9}~\msun$ \\
$r_{\rm B}$ & $1~\kpc$ \\
\hline
$M_{\rm N}$ & $1.76 \times 10^{9}~\msun$ \\
$r_{\rm N}$ & $67.9~\pc$ \\
\enddata

\end{deluxetable}
\end{floattable}

\begin{figure*}[h]
\begin{center}
\includegraphics[width=0.65\textwidth]{figures/mass-evolution.pdf}
\end{center}
\caption{%
\todo{caption}
\label{fig:mass-evolution}}
\end{figure*}

\subsection{Globular cluster initial mass distribution} \label{sec:gcmassdist}

We assume that the initial cluster masses $m_0$ are drawn from a power-law
mass distribution (e.g., \citealt{Gnedin:2014}):
\begin{eqnarray}
  p(M_0) = A \, M_0^{-2}, \quad M_{\rm min} < M_0 < M_{\rm max},
\end{eqnarray}
where $M_{\rm min} = 10^4~\msun$, $M_{\rm max} = 10^7~\msun$, and $A$ is the
normalization constant.
The power-law exponent ($\beta = 2$) is consistent with observed young massive
star clusters in nearby galaxies (\citealt{TODO}).
The minimum mass scale is somewhat arbitrary, but we expect lower mass clusters
to disrupt very early and probably before they are tidally stripped from their
host systems.
The maximum mass scale is fixed to the fiducial value used in
\citealt{Gnedin:2014}.
\todo{Eve Ostriker suggested setting $M_{min}$ = the minimum observed mass we see
today instead of an arbitrary cutoff of $10^4$ since we're just trying to
reproduce the ones we see now.}

\subsection{Cluster orbits} \label{sec:aqorbits}

The orbits of the individual clusters are either drawn from (1) a spherical,
isotropic distribution function embedded in the background Milky Way potential
or (2) are assumed to be accreted cosmologically in satellites and deposited
into the Milky Way once the satellites fully disrupt.

\subsubsection{Scenario 1: Embedded spherical distribution function} \label{sec:sphdf}

For this scenario, we follow previous work and assume that the density profile
of the initial globular cluster system follows a S\'ersic profile with effective
radius $R_e=4$ and index $n_s = 2.2$ (see \sectionname~3 in
\citealt{Gnedin:2014}).
This choice comes from assuming that, if the globular cluster system were in
place at an early time, the density profile of clusters, $\nu(r)$, likely
follows that of the stars (which is approximately S\'ersic).
We use this tracer density profile $\nu(r)$ and compute a spherically-averaged
version of the instantaneous Milky Way mass model to evaluate the relative
potential $\Psi(r) = -\Phi_{\rm MW}(r,t)$ and use Eddington's formula
(\citealt{Eddington:1916,Binney:2008}) to evaluate the \df, $f(\mathcal{E})$,
along a grid of relative energies $\mathcal{E} = \Psi - \frac{1}{2}v^2$:
\begin{eqnarray}
  f(\mathcal{E}) &=& \frac{1}{\sqrt{8}\,\pi} \, \frac{\dd}{\dd \mathcal{E}}
    \int_0^\mathcal{E} \, \frac{\dd \Psi}{\sqrt{\mathcal{E} - \Psi}} \,
    \frac{\dd \nu}{\dd \Psi} \quad .
\end{eqnarray}
We use inverse-transform sampling to sample radii from the tracer density
profile $\nu(r)$, then use rejection-sampling (\citealt{vonneumann}) to sample
velocity magnitudes from the \df\ at each radius.
We convert radius and velocity magnitude to full-space position and velocity
assuming isotropy.

\subsubsection{Case 2: Cosmological orbits from the Aquarius simulations} \label{sec:cosmoorbits}

todo

\subsection{Mass evolution of the clusters} \label{sec:mockstreams}

Our goal is to produce mock stellar halos of stellar debris lost from the
globular clusters as they evolve along their orbits within the Milky Way.
All of the stars stripped from a given cluster will initially remain close to
the cluster and form coherent tidal tails, but older tidal debris will phase-mix
and form a smoother background distribution (e.g., \citealt{Helmi:1999}).
Our approach is to generate simulated stellar streams without running full
$N$-body simulations by using an approximate method for populating the tidal
tails that form around each cluster.
In recent years, significant effort has been devoted to developing such methods
to generate model stellar streams to compare with observed stream star
kinematics for, e.g., measuring the gravitational field of the Milky Way
(\citealt{Kupper:2012,Bonaca:2014,Gibbons:2014,Bovy:2014,Fardal:2015}).
These methods operate in a similar way:
Given the orbit and mass evolution of a progenitor system (e.g., globular
cluster), star particles are released from the Lagrange points of the satellite
with a spread in position and velocity set by the mass of the satellite (e.g.,
\citealt{Johnston:1999}) and some tunable scale parameters.
In this work, we use the parametrization of \citealt{Fardal:2015}, who fit the
release distribution parameters by comparing to full $N$-body simulations across
a range of mass and orbital parameters.

These methods accurately reproduce the mean tracks of the streams that form, but
the density of stars along the streams is determined by the mass-loss from the
progenitor system.
The mass evolution is typically assumed to be approximately linear with time so
that equal-mass star particles can be released from the Lagrange points at
regular time intervals (e.g., in sync with the integration of the progenitor
orbit).
In this work, we initially populate the stream particles using a constant
mass-loss rate, but separately solve for the cluster mass evolution to compute
the instantaneous mass-loss rate from the cluster at every time.
We then use this mass-loss rate to weight the model stream particle masses
to better capture the true density structure along each stream.

\subsection{Cluster mass evolution} \label{sec:gcmassevolution}

We solve for the mass evolution of a cluster given its initial mass and full
orbit using a semi-analytical method similar to that described in
\citet{Gnedin:2014} (hereafter G14).
G14 simultaneously solve for the mass and mean-radius evolution of ensembles
of globular clusters using analytic prescriptions for cluster mass-loss due to
evaporation ($t_{\rm iso}$), tidal stripping ($t_{\rm tid}$), and stellar
evolution ($t_{\rm se}$) and orbital radius evolution from dynamical friction
($t_{\rm df}$).
As we are mainly interested in the halo globular clusters, in this work we
neglect dynamical friction---the dynamical friction timescale for our maximum
mass cluster ($10^7~\msun$) at a Galactocentric distance of 10 kpc is much
longer than a Hubble time even for a moderately eccentric orbit.
We use these timescales (see also \eqname s~3--8 in \citealt{Gnedin:2014}) to
numerically integrate a simple differential equation for cluster mass $M$:
\begin{eqnarray}
  \frac{\dd M}{\dd t} &=& \, -\frac{M}{\min\left(t_{\rm iso}, t_{\rm tid}, t_{\rm se}\right)}
\end{eqnarray}
where the timescales are generally functions of both mass and mean orbital
radius.
This simple model for cluster mass evolution is approximate in many ways, but
perhaps the most severe assumption is that it ignores gravitational shocking of
clusters on eccentric orbits:
Each cluster is assumed to be on a circular orbit at the mean orbital radius
along its orbit.

For cases when a GC is accreted from a satellite galaxy, we first solve for
the mass-loss of the cluster within the satellite system up until it passes the
tidal radius.
At this point, we begin evolving the mass of the cluster in the tidal field of
the Milky Way instead.
When generating mock stellar streams for the GCs, we only consider stars that
are disrupted after the GC is stripped from its parent.

This simple procedure is only used to determine the mass-loss history of a given
cluster.

\section{Results 1: Coherent structures and thin streams}

Number of streams, distribution of lengths, mass in coherent structures?

\section{Results 2: Phase-mixed debris and kinematic substructure}

Solar neighborhood, Gaia volume + uncertainties

\section{Discussion}\label{sec:discussion}

Caveats:
\begin{itemize}
  \item Simple potential model - not cosmological, spherical halo, no
    substructure, no bar!
  \item Neglect stars deposited from dwarf galaxies - will dominate the stellar
    halo. We are imagining being able to distinguish these from GC stars using
    detailed abundances.
  \item Bimodality in metallicity distribution -- present population probably a
    mixture of in situ and accreted. In situ probably had angular momentum, but
    we ignore...
\end{itemize}

\section{Conclusions} \label{sec:conclusions}

Number of thin streams more consistent with X...

Compare kinematic clustering to chemical clustering to see how much chaos there
is, how much potential has evolved since majority disrupted

If similar, then amount of clumpiness tells you the initial population of GCs --
star formation in early universe, globular cluster populations in dwarf
galaxies, etc.

\acknowledgements
This research made use of
Astropy, a community-developed core Python package for Astronomy
\citep{Astropy-Collaboration:2013}.

\bibliographystyle{aasjournal}
\bibliography{mwgcs}

\end{document}
